{"version":3,"file":"router_config_loader.js","sourceRoot":"","sources":["../../../../modules/@angular/router/src/router_config_loader.ts"],"names":[],"mappings":"AAAA;;;;;;GAMG;;AAEH,qBAAgH,eAAe,CAAC,CAAA;AAEhI,4BAA0B,6BAA6B,CAAC,CAAA;AACxD,mBAAkB,oBAAoB,CAAC,CAAA;AAGvC,2BAA0C,oBAAoB,CAAC,CAAA;AAGlD,cAAM,GAAG,IAAI,kBAAW,CAAC,QAAQ,CAAC,CAAC;AAEhD;IACE,4BACW,MAAe,EAAS,QAAkB,EAC1C,eAAyC;QADzC,WAAM,GAAN,MAAM,CAAS;QAAS,aAAQ,GAAR,QAAQ,CAAU;QAC1C,oBAAe,GAAf,eAAe,CAA0B;IAAG,CAAC;IAC1D,yBAAC;AAAD,CAAC,AAJD,IAIC;AAJY,0BAAkB,qBAI9B,CAAA;AAED;IACE,4BAAoB,MAA6B,EAAU,QAAkB;QAAzD,WAAM,GAAN,MAAM,CAAuB;QAAU,aAAQ,GAAR,QAAQ,CAAU;IAAG,CAAC;IAEjF,iCAAI,GAAJ,UAAK,cAAwB,EAAE,YAA0B;QACvD,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,UAAA,CAAC;YAC/C,IAAM,GAAG,GAAG,CAAC,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC;YACrC,MAAM,CAAC,IAAI,kBAAkB,CACzB,oBAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,GAAG,CAAC,cAAM,CAAC,CAAC,EAAE,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,wBAAwB,CAAC,CAAC;QACrF,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,8CAAiB,GAAzB,UAA0B,YAA0B;QAApD,iBASC;QARC,EAAE,CAAC,CAAC,OAAO,YAAY,KAAK,QAAQ,CAAC,CAAC,CAAC;YACrC,MAAM,CAAC,yBAAW,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC;QACrD,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAM,aAAW,GAAG,IAAI,CAAC,QAAQ,YAAY,eAAQ,CAAC;YACtD,MAAM,CAAC,+BAAkB,CAAC,YAAY,EAAE,CAAC;iBACpC,QAAQ,CACL,UAAA,CAAC,IAAI,OAAA,aAAW,GAAG,OAAE,CAAO,CAAC,CAAC,GAAG,yBAAW,CAAC,KAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,EAA5E,CAA4E,CAAC,CAAC;QAC7F,CAAC;IACH,CAAC;IACH,yBAAC;AAAD,CAAC,AArBD,IAqBC;AArBY,0BAAkB,qBAqB9B,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Compiler, ComponentFactoryResolver, Injector, NgModuleFactory, NgModuleFactoryLoader, OpaqueToken} from '@angular/core';\nimport {Observable} from 'rxjs/Observable';\nimport {fromPromise} from 'rxjs/observable/fromPromise';\nimport {of } from 'rxjs/observable/of';\n\nimport {LoadChildren, Route} from './config';\nimport {flatten, wrapIntoObservable} from './utils/collection';\n\n\nexport const ROUTES = new OpaqueToken('ROUTES');\n\nexport class LoadedRouterConfig {\n  constructor(\n      public routes: Route[], public injector: Injector,\n      public factoryResolver: ComponentFactoryResolver) {}\n}\n\nexport class RouterConfigLoader {\n  constructor(private loader: NgModuleFactoryLoader, private compiler: Compiler) {}\n\n  load(parentInjector: Injector, loadChildren: LoadChildren): Observable<LoadedRouterConfig> {\n    return this.loadModuleFactory(loadChildren).map(r => {\n      const ref = r.create(parentInjector);\n      return new LoadedRouterConfig(\n          flatten(ref.injector.get(ROUTES)), ref.injector, ref.componentFactoryResolver);\n    });\n  }\n\n  private loadModuleFactory(loadChildren: LoadChildren): Observable<NgModuleFactory<any>> {\n    if (typeof loadChildren === 'string') {\n      return fromPromise(this.loader.load(loadChildren));\n    } else {\n      const offlineMode = this.compiler instanceof Compiler;\n      return wrapIntoObservable(loadChildren())\n          .mergeMap(\n              t => offlineMode ? of (<any>t) : fromPromise(this.compiler.compileModuleAsync(t)));\n    }\n  }\n}\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}